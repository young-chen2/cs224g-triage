"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/* eslint-disable import/no-extraneous-dependencies */
const reporters_1 = require("@jest/reporters");
const reporter_js_1 = require("../utils/jestlike/reporter.cjs");
class LangSmithEvalReporter extends reporters_1.DefaultReporter {
    async onTestResult(test, testResult, aggregatedResults) {
        const groupedTestResults = testResult.testResults.reduce((groups, testResult) => {
            const ancestorTitle = testResult.ancestorTitles.join(" > ");
            if (groups[ancestorTitle] === undefined) {
                groups[ancestorTitle] = [];
            }
            groups[ancestorTitle].push(testResult);
            return groups;
        }, {});
        try {
            for (const testGroupName of Object.keys(groupedTestResults)) {
                const resultGroup = groupedTestResults[testGroupName];
                await (0, reporter_js_1.printReporterTable)(resultGroup, testResult.failureMessage);
            }
        }
        catch (e) {
            console.log("Failed to display LangSmith eval results:", e.message);
            super.onTestResult(test, testResult, aggregatedResults);
        }
    }
}
exports.default = LangSmithEvalReporter;
