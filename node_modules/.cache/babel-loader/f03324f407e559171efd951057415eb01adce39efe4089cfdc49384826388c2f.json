{"ast":null,"code":"import { APIConnectionTimeoutError, APIUserAbortError } from \"openai\";\nimport { zodToJsonSchema } from \"zod-to-json-schema\";\nimport { convertToOpenAIFunction, convertToOpenAITool } from \"@langchain/core/utils/function_calling\";\nimport { addLangChainErrorFields } from \"./errors.js\";\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function wrapOpenAIClientError(e) {\n  let error;\n  if (e.constructor.name === APIConnectionTimeoutError.name) {\n    error = new Error(e.message);\n    error.name = \"TimeoutError\";\n  } else if (e.constructor.name === APIUserAbortError.name) {\n    error = new Error(e.message);\n    error.name = \"AbortError\";\n  } else if (e.status === 400 && e.message.includes(\"tool_calls\")) {\n    error = addLangChainErrorFields(e, \"INVALID_TOOL_RESULTS\");\n  } else if (e.status === 401) {\n    error = addLangChainErrorFields(e, \"MODEL_AUTHENTICATION\");\n  } else if (e.status === 429) {\n    error = addLangChainErrorFields(e, \"MODEL_RATE_LIMIT\");\n  } else if (e.status === 404) {\n    error = addLangChainErrorFields(e, \"MODEL_NOT_FOUND\");\n  } else {\n    error = e;\n  }\n  return error;\n}\nexport { convertToOpenAIFunction as formatToOpenAIFunction, convertToOpenAITool as formatToOpenAITool };\nexport function formatToOpenAIAssistantTool(tool) {\n  return {\n    type: \"function\",\n    function: {\n      name: tool.name,\n      description: tool.description,\n      parameters: zodToJsonSchema(tool.schema)\n    }\n  };\n}\nexport function formatToOpenAIToolChoice(toolChoice) {\n  if (!toolChoice) {\n    return undefined;\n  } else if (toolChoice === \"any\" || toolChoice === \"required\") {\n    return \"required\";\n  } else if (toolChoice === \"auto\") {\n    return \"auto\";\n  } else if (toolChoice === \"none\") {\n    return \"none\";\n  } else if (typeof toolChoice === \"string\") {\n    return {\n      type: \"function\",\n      function: {\n        name: toolChoice\n      }\n    };\n  } else {\n    return toolChoice;\n  }\n}","map":{"version":3,"names":["APIConnectionTimeoutError","APIUserAbortError","zodToJsonSchema","convertToOpenAIFunction","convertToOpenAITool","addLangChainErrorFields","wrapOpenAIClientError","e","error","constructor","name","Error","message","status","includes","formatToOpenAIFunction","formatToOpenAITool","formatToOpenAIAssistantTool","tool","type","function","description","parameters","schema","formatToOpenAIToolChoice","toolChoice","undefined"],"sources":["/Users/youngchen/Downloads/cs224g-triage/node_modules/@langchain/openai/dist/utils/openai.js"],"sourcesContent":["import { APIConnectionTimeoutError, APIUserAbortError, } from \"openai\";\nimport { zodToJsonSchema } from \"zod-to-json-schema\";\nimport { convertToOpenAIFunction, convertToOpenAITool, } from \"@langchain/core/utils/function_calling\";\nimport { addLangChainErrorFields } from \"./errors.js\";\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function wrapOpenAIClientError(e) {\n    let error;\n    if (e.constructor.name === APIConnectionTimeoutError.name) {\n        error = new Error(e.message);\n        error.name = \"TimeoutError\";\n    }\n    else if (e.constructor.name === APIUserAbortError.name) {\n        error = new Error(e.message);\n        error.name = \"AbortError\";\n    }\n    else if (e.status === 400 && e.message.includes(\"tool_calls\")) {\n        error = addLangChainErrorFields(e, \"INVALID_TOOL_RESULTS\");\n    }\n    else if (e.status === 401) {\n        error = addLangChainErrorFields(e, \"MODEL_AUTHENTICATION\");\n    }\n    else if (e.status === 429) {\n        error = addLangChainErrorFields(e, \"MODEL_RATE_LIMIT\");\n    }\n    else if (e.status === 404) {\n        error = addLangChainErrorFields(e, \"MODEL_NOT_FOUND\");\n    }\n    else {\n        error = e;\n    }\n    return error;\n}\nexport { convertToOpenAIFunction as formatToOpenAIFunction, convertToOpenAITool as formatToOpenAITool, };\nexport function formatToOpenAIAssistantTool(tool) {\n    return {\n        type: \"function\",\n        function: {\n            name: tool.name,\n            description: tool.description,\n            parameters: zodToJsonSchema(tool.schema),\n        },\n    };\n}\nexport function formatToOpenAIToolChoice(toolChoice) {\n    if (!toolChoice) {\n        return undefined;\n    }\n    else if (toolChoice === \"any\" || toolChoice === \"required\") {\n        return \"required\";\n    }\n    else if (toolChoice === \"auto\") {\n        return \"auto\";\n    }\n    else if (toolChoice === \"none\") {\n        return \"none\";\n    }\n    else if (typeof toolChoice === \"string\") {\n        return {\n            type: \"function\",\n            function: {\n                name: toolChoice,\n            },\n        };\n    }\n    else {\n        return toolChoice;\n    }\n}\n"],"mappings":"AAAA,SAASA,yBAAyB,EAAEC,iBAAiB,QAAS,QAAQ;AACtE,SAASC,eAAe,QAAQ,oBAAoB;AACpD,SAASC,uBAAuB,EAAEC,mBAAmB,QAAS,wCAAwC;AACtG,SAASC,uBAAuB,QAAQ,aAAa;AACrD;AACA,OAAO,SAASC,qBAAqBA,CAACC,CAAC,EAAE;EACrC,IAAIC,KAAK;EACT,IAAID,CAAC,CAACE,WAAW,CAACC,IAAI,KAAKV,yBAAyB,CAACU,IAAI,EAAE;IACvDF,KAAK,GAAG,IAAIG,KAAK,CAACJ,CAAC,CAACK,OAAO,CAAC;IAC5BJ,KAAK,CAACE,IAAI,GAAG,cAAc;EAC/B,CAAC,MACI,IAAIH,CAAC,CAACE,WAAW,CAACC,IAAI,KAAKT,iBAAiB,CAACS,IAAI,EAAE;IACpDF,KAAK,GAAG,IAAIG,KAAK,CAACJ,CAAC,CAACK,OAAO,CAAC;IAC5BJ,KAAK,CAACE,IAAI,GAAG,YAAY;EAC7B,CAAC,MACI,IAAIH,CAAC,CAACM,MAAM,KAAK,GAAG,IAAIN,CAAC,CAACK,OAAO,CAACE,QAAQ,CAAC,YAAY,CAAC,EAAE;IAC3DN,KAAK,GAAGH,uBAAuB,CAACE,CAAC,EAAE,sBAAsB,CAAC;EAC9D,CAAC,MACI,IAAIA,CAAC,CAACM,MAAM,KAAK,GAAG,EAAE;IACvBL,KAAK,GAAGH,uBAAuB,CAACE,CAAC,EAAE,sBAAsB,CAAC;EAC9D,CAAC,MACI,IAAIA,CAAC,CAACM,MAAM,KAAK,GAAG,EAAE;IACvBL,KAAK,GAAGH,uBAAuB,CAACE,CAAC,EAAE,kBAAkB,CAAC;EAC1D,CAAC,MACI,IAAIA,CAAC,CAACM,MAAM,KAAK,GAAG,EAAE;IACvBL,KAAK,GAAGH,uBAAuB,CAACE,CAAC,EAAE,iBAAiB,CAAC;EACzD,CAAC,MACI;IACDC,KAAK,GAAGD,CAAC;EACb;EACA,OAAOC,KAAK;AAChB;AACA,SAASL,uBAAuB,IAAIY,sBAAsB,EAAEX,mBAAmB,IAAIY,kBAAkB;AACrG,OAAO,SAASC,2BAA2BA,CAACC,IAAI,EAAE;EAC9C,OAAO;IACHC,IAAI,EAAE,UAAU;IAChBC,QAAQ,EAAE;MACNV,IAAI,EAAEQ,IAAI,CAACR,IAAI;MACfW,WAAW,EAAEH,IAAI,CAACG,WAAW;MAC7BC,UAAU,EAAEpB,eAAe,CAACgB,IAAI,CAACK,MAAM;IAC3C;EACJ,CAAC;AACL;AACA,OAAO,SAASC,wBAAwBA,CAACC,UAAU,EAAE;EACjD,IAAI,CAACA,UAAU,EAAE;IACb,OAAOC,SAAS;EACpB,CAAC,MACI,IAAID,UAAU,KAAK,KAAK,IAAIA,UAAU,KAAK,UAAU,EAAE;IACxD,OAAO,UAAU;EACrB,CAAC,MACI,IAAIA,UAAU,KAAK,MAAM,EAAE;IAC5B,OAAO,MAAM;EACjB,CAAC,MACI,IAAIA,UAAU,KAAK,MAAM,EAAE;IAC5B,OAAO,MAAM;EACjB,CAAC,MACI,IAAI,OAAOA,UAAU,KAAK,QAAQ,EAAE;IACrC,OAAO;MACHN,IAAI,EAAE,UAAU;MAChBC,QAAQ,EAAE;QACNV,IAAI,EAAEe;MACV;IACJ,CAAC;EACL,CAAC,MACI;IACD,OAAOA,UAAU;EACrB;AACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}