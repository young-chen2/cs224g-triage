{"ast":null,"code":"import { parseDef } from \"./parseDef.js\";\nimport { getRefs } from \"./Refs.js\";\nconst zodToJsonSchema = (schema, options) => {\n  const refs = getRefs(options);\n  const definitions = typeof options === \"object\" && options.definitions ? Object.entries(options.definitions).reduce((acc, [name, schema]) => ({\n    ...acc,\n    [name]: parseDef(schema._def, {\n      ...refs,\n      currentPath: [...refs.basePath, refs.definitionPath, name]\n    }, true) ?? {}\n  }), {}) : undefined;\n  const name = typeof options === \"string\" ? options : options?.nameStrategy === \"title\" ? undefined : options?.name;\n  const main = parseDef(schema._def, name === undefined ? refs : {\n    ...refs,\n    currentPath: [...refs.basePath, refs.definitionPath, name]\n  }, false) ?? {};\n  const title = typeof options === \"object\" && options.name !== undefined && options.nameStrategy === \"title\" ? options.name : undefined;\n  if (title !== undefined) {\n    main.title = title;\n  }\n  const combined = name === undefined ? definitions ? {\n    ...main,\n    [refs.definitionPath]: definitions\n  } : main : {\n    $ref: [...(refs.$refStrategy === \"relative\" ? [] : refs.basePath), refs.definitionPath, name].join(\"/\"),\n    [refs.definitionPath]: {\n      ...definitions,\n      [name]: main\n    }\n  };\n  if (refs.target === \"jsonSchema7\") {\n    combined.$schema = \"http://json-schema.org/draft-07/schema#\";\n  } else if (refs.target === \"jsonSchema2019-09\" || refs.target === \"openAi\") {\n    combined.$schema = \"https://json-schema.org/draft/2019-09/schema#\";\n  }\n  if (refs.target === \"openAi\" && (\"anyOf\" in combined || \"oneOf\" in combined || \"allOf\" in combined || \"type\" in combined && Array.isArray(combined.type))) {\n    console.warn(\"Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property.\");\n  }\n  return combined;\n};\nexport { zodToJsonSchema };","map":{"version":3,"names":["parseDef","getRefs","zodToJsonSchema","schema","options","refs","definitions","Object","entries","reduce","acc","name","_def","currentPath","basePath","definitionPath","undefined","nameStrategy","main","title","combined","$ref","$refStrategy","join","target","$schema","Array","isArray","type","console","warn"],"sources":["/Users/youngchen/Downloads/cs224g-triage/node_modules/zod-to-json-schema/dist/esm/zodToJsonSchema.js"],"sourcesContent":["import { parseDef } from \"./parseDef.js\";\nimport { getRefs } from \"./Refs.js\";\nconst zodToJsonSchema = (schema, options) => {\n    const refs = getRefs(options);\n    const definitions = typeof options === \"object\" && options.definitions\n        ? Object.entries(options.definitions).reduce((acc, [name, schema]) => ({\n            ...acc,\n            [name]: parseDef(schema._def, {\n                ...refs,\n                currentPath: [...refs.basePath, refs.definitionPath, name],\n            }, true) ?? {},\n        }), {})\n        : undefined;\n    const name = typeof options === \"string\"\n        ? options\n        : options?.nameStrategy === \"title\"\n            ? undefined\n            : options?.name;\n    const main = parseDef(schema._def, name === undefined\n        ? refs\n        : {\n            ...refs,\n            currentPath: [...refs.basePath, refs.definitionPath, name],\n        }, false) ?? {};\n    const title = typeof options === \"object\" &&\n        options.name !== undefined &&\n        options.nameStrategy === \"title\"\n        ? options.name\n        : undefined;\n    if (title !== undefined) {\n        main.title = title;\n    }\n    const combined = name === undefined\n        ? definitions\n            ? {\n                ...main,\n                [refs.definitionPath]: definitions,\n            }\n            : main\n        : {\n            $ref: [\n                ...(refs.$refStrategy === \"relative\" ? [] : refs.basePath),\n                refs.definitionPath,\n                name,\n            ].join(\"/\"),\n            [refs.definitionPath]: {\n                ...definitions,\n                [name]: main,\n            },\n        };\n    if (refs.target === \"jsonSchema7\") {\n        combined.$schema = \"http://json-schema.org/draft-07/schema#\";\n    }\n    else if (refs.target === \"jsonSchema2019-09\" || refs.target === \"openAi\") {\n        combined.$schema = \"https://json-schema.org/draft/2019-09/schema#\";\n    }\n    if (refs.target === \"openAi\" &&\n        (\"anyOf\" in combined ||\n            \"oneOf\" in combined ||\n            \"allOf\" in combined ||\n            (\"type\" in combined && Array.isArray(combined.type)))) {\n        console.warn(\"Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property.\");\n    }\n    return combined;\n};\nexport { zodToJsonSchema };\n"],"mappings":"AAAA,SAASA,QAAQ,QAAQ,eAAe;AACxC,SAASC,OAAO,QAAQ,WAAW;AACnC,MAAMC,eAAe,GAAGA,CAACC,MAAM,EAAEC,OAAO,KAAK;EACzC,MAAMC,IAAI,GAAGJ,OAAO,CAACG,OAAO,CAAC;EAC7B,MAAME,WAAW,GAAG,OAAOF,OAAO,KAAK,QAAQ,IAAIA,OAAO,CAACE,WAAW,GAChEC,MAAM,CAACC,OAAO,CAACJ,OAAO,CAACE,WAAW,CAAC,CAACG,MAAM,CAAC,CAACC,GAAG,EAAE,CAACC,IAAI,EAAER,MAAM,CAAC,MAAM;IACnE,GAAGO,GAAG;IACN,CAACC,IAAI,GAAGX,QAAQ,CAACG,MAAM,CAACS,IAAI,EAAE;MAC1B,GAAGP,IAAI;MACPQ,WAAW,EAAE,CAAC,GAAGR,IAAI,CAACS,QAAQ,EAAET,IAAI,CAACU,cAAc,EAAEJ,IAAI;IAC7D,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC;EACjB,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GACLK,SAAS;EACf,MAAML,IAAI,GAAG,OAAOP,OAAO,KAAK,QAAQ,GAClCA,OAAO,GACPA,OAAO,EAAEa,YAAY,KAAK,OAAO,GAC7BD,SAAS,GACTZ,OAAO,EAAEO,IAAI;EACvB,MAAMO,IAAI,GAAGlB,QAAQ,CAACG,MAAM,CAACS,IAAI,EAAED,IAAI,KAAKK,SAAS,GAC/CX,IAAI,GACJ;IACE,GAAGA,IAAI;IACPQ,WAAW,EAAE,CAAC,GAAGR,IAAI,CAACS,QAAQ,EAAET,IAAI,CAACU,cAAc,EAAEJ,IAAI;EAC7D,CAAC,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;EACnB,MAAMQ,KAAK,GAAG,OAAOf,OAAO,KAAK,QAAQ,IACrCA,OAAO,CAACO,IAAI,KAAKK,SAAS,IAC1BZ,OAAO,CAACa,YAAY,KAAK,OAAO,GAC9Bb,OAAO,CAACO,IAAI,GACZK,SAAS;EACf,IAAIG,KAAK,KAAKH,SAAS,EAAE;IACrBE,IAAI,CAACC,KAAK,GAAGA,KAAK;EACtB;EACA,MAAMC,QAAQ,GAAGT,IAAI,KAAKK,SAAS,GAC7BV,WAAW,GACP;IACE,GAAGY,IAAI;IACP,CAACb,IAAI,CAACU,cAAc,GAAGT;EAC3B,CAAC,GACCY,IAAI,GACR;IACEG,IAAI,EAAE,CACF,IAAIhB,IAAI,CAACiB,YAAY,KAAK,UAAU,GAAG,EAAE,GAAGjB,IAAI,CAACS,QAAQ,CAAC,EAC1DT,IAAI,CAACU,cAAc,EACnBJ,IAAI,CACP,CAACY,IAAI,CAAC,GAAG,CAAC;IACX,CAAClB,IAAI,CAACU,cAAc,GAAG;MACnB,GAAGT,WAAW;MACd,CAACK,IAAI,GAAGO;IACZ;EACJ,CAAC;EACL,IAAIb,IAAI,CAACmB,MAAM,KAAK,aAAa,EAAE;IAC/BJ,QAAQ,CAACK,OAAO,GAAG,yCAAyC;EAChE,CAAC,MACI,IAAIpB,IAAI,CAACmB,MAAM,KAAK,mBAAmB,IAAInB,IAAI,CAACmB,MAAM,KAAK,QAAQ,EAAE;IACtEJ,QAAQ,CAACK,OAAO,GAAG,+CAA+C;EACtE;EACA,IAAIpB,IAAI,CAACmB,MAAM,KAAK,QAAQ,KACvB,OAAO,IAAIJ,QAAQ,IAChB,OAAO,IAAIA,QAAQ,IACnB,OAAO,IAAIA,QAAQ,IAClB,MAAM,IAAIA,QAAQ,IAAIM,KAAK,CAACC,OAAO,CAACP,QAAQ,CAACQ,IAAI,CAAE,CAAC,EAAE;IAC3DC,OAAO,CAACC,IAAI,CAAC,sGAAsG,CAAC;EACxH;EACA,OAAOV,QAAQ;AACnB,CAAC;AACD,SAASlB,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}