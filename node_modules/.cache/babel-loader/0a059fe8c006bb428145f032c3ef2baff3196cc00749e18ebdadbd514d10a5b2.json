{"ast":null,"code":"import { ZodFirstPartyTypeKind } from \"zod\";\nimport { parseDef } from \"../parseDef.js\";\nimport { parseStringDef } from \"./string.js\";\nimport { parseBrandedDef } from \"./branded.js\";\nexport function parseRecordDef(def, refs) {\n  if (refs.target === \"openAi\") {\n    console.warn(\"Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead.\");\n  }\n  if (refs.target === \"openApi3\" && def.keyType?._def.typeName === ZodFirstPartyTypeKind.ZodEnum) {\n    return {\n      type: \"object\",\n      required: def.keyType._def.values,\n      properties: def.keyType._def.values.reduce((acc, key) => ({\n        ...acc,\n        [key]: parseDef(def.valueType._def, {\n          ...refs,\n          currentPath: [...refs.currentPath, \"properties\", key]\n        }) ?? {}\n      }), {}),\n      additionalProperties: false\n    };\n  }\n  const schema = {\n    type: \"object\",\n    additionalProperties: parseDef(def.valueType._def, {\n      ...refs,\n      currentPath: [...refs.currentPath, \"additionalProperties\"]\n    }) ?? {}\n  };\n  if (refs.target === \"openApi3\") {\n    return schema;\n  }\n  if (def.keyType?._def.typeName === ZodFirstPartyTypeKind.ZodString && def.keyType._def.checks?.length) {\n    const {\n      type,\n      ...keyType\n    } = parseStringDef(def.keyType._def, refs);\n    return {\n      ...schema,\n      propertyNames: keyType\n    };\n  } else if (def.keyType?._def.typeName === ZodFirstPartyTypeKind.ZodEnum) {\n    return {\n      ...schema,\n      propertyNames: {\n        enum: def.keyType._def.values\n      }\n    };\n  } else if (def.keyType?._def.typeName === ZodFirstPartyTypeKind.ZodBranded && def.keyType._def.type._def.typeName === ZodFirstPartyTypeKind.ZodString && def.keyType._def.type._def.checks?.length) {\n    const {\n      type,\n      ...keyType\n    } = parseBrandedDef(def.keyType._def, refs);\n    return {\n      ...schema,\n      propertyNames: keyType\n    };\n  }\n  return schema;\n}","map":{"version":3,"names":["ZodFirstPartyTypeKind","parseDef","parseStringDef","parseBrandedDef","parseRecordDef","def","refs","target","console","warn","keyType","_def","typeName","ZodEnum","type","required","values","properties","reduce","acc","key","valueType","currentPath","additionalProperties","schema","ZodString","checks","length","propertyNames","enum","ZodBranded"],"sources":["/Users/youngchen/Downloads/cs224g-triage/node_modules/zod-to-json-schema/dist/esm/parsers/record.js"],"sourcesContent":["import { ZodFirstPartyTypeKind, } from \"zod\";\nimport { parseDef } from \"../parseDef.js\";\nimport { parseStringDef } from \"./string.js\";\nimport { parseBrandedDef } from \"./branded.js\";\nexport function parseRecordDef(def, refs) {\n    if (refs.target === \"openAi\") {\n        console.warn(\"Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead.\");\n    }\n    if (refs.target === \"openApi3\" &&\n        def.keyType?._def.typeName === ZodFirstPartyTypeKind.ZodEnum) {\n        return {\n            type: \"object\",\n            required: def.keyType._def.values,\n            properties: def.keyType._def.values.reduce((acc, key) => ({\n                ...acc,\n                [key]: parseDef(def.valueType._def, {\n                    ...refs,\n                    currentPath: [...refs.currentPath, \"properties\", key],\n                }) ?? {},\n            }), {}),\n            additionalProperties: false,\n        };\n    }\n    const schema = {\n        type: \"object\",\n        additionalProperties: parseDef(def.valueType._def, {\n            ...refs,\n            currentPath: [...refs.currentPath, \"additionalProperties\"],\n        }) ?? {},\n    };\n    if (refs.target === \"openApi3\") {\n        return schema;\n    }\n    if (def.keyType?._def.typeName === ZodFirstPartyTypeKind.ZodString &&\n        def.keyType._def.checks?.length) {\n        const { type, ...keyType } = parseStringDef(def.keyType._def, refs);\n        return {\n            ...schema,\n            propertyNames: keyType,\n        };\n    }\n    else if (def.keyType?._def.typeName === ZodFirstPartyTypeKind.ZodEnum) {\n        return {\n            ...schema,\n            propertyNames: {\n                enum: def.keyType._def.values,\n            },\n        };\n    }\n    else if (def.keyType?._def.typeName === ZodFirstPartyTypeKind.ZodBranded &&\n        def.keyType._def.type._def.typeName === ZodFirstPartyTypeKind.ZodString &&\n        def.keyType._def.type._def.checks?.length) {\n        const { type, ...keyType } = parseBrandedDef(def.keyType._def, refs);\n        return {\n            ...schema,\n            propertyNames: keyType,\n        };\n    }\n    return schema;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}