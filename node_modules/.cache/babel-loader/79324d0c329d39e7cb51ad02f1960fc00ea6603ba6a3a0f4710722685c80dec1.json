{"ast":null,"code":"function isAnyOfProp(prop) {\n  return prop.anyOf !== undefined && Array.isArray(prop.anyOf);\n}\n// When OpenAI use functions in the prompt, they format them as TypeScript definitions rather than OpenAPI JSON schemas.\n// This function converts the JSON schemas into TypeScript definitions.\nexport function formatFunctionDefinitions(functions) {\n  const lines = [\"namespace functions {\", \"\"];\n  for (const f of functions) {\n    if (f.description) {\n      lines.push(`// ${f.description}`);\n    }\n    if (Object.keys(f.parameters.properties ?? {}).length > 0) {\n      lines.push(`type ${f.name} = (_: {`);\n      lines.push(formatObjectProperties(f.parameters, 0));\n      lines.push(\"}) => any;\");\n    } else {\n      lines.push(`type ${f.name} = () => any;`);\n    }\n    lines.push(\"\");\n  }\n  lines.push(\"} // namespace functions\");\n  return lines.join(\"\\n\");\n}\n// Format just the properties of an object (not including the surrounding braces)\nfunction formatObjectProperties(obj, indent) {\n  const lines = [];\n  for (const [name, param] of Object.entries(obj.properties ?? {})) {\n    if (param.description && indent < 2) {\n      lines.push(`// ${param.description}`);\n    }\n    if (obj.required?.includes(name)) {\n      lines.push(`${name}: ${formatType(param, indent)},`);\n    } else {\n      lines.push(`${name}?: ${formatType(param, indent)},`);\n    }\n  }\n  return lines.map(line => \" \".repeat(indent) + line).join(\"\\n\");\n}\n// Format a single property type\nfunction formatType(param, indent) {\n  if (isAnyOfProp(param)) {\n    return param.anyOf.map(v => formatType(v, indent)).join(\" | \");\n  }\n  switch (param.type) {\n    case \"string\":\n      if (param.enum) {\n        return param.enum.map(v => `\"${v}\"`).join(\" | \");\n      }\n      return \"string\";\n    case \"number\":\n      if (param.enum) {\n        return param.enum.map(v => `${v}`).join(\" | \");\n      }\n      return \"number\";\n    case \"integer\":\n      if (param.enum) {\n        return param.enum.map(v => `${v}`).join(\" | \");\n      }\n      return \"number\";\n    case \"boolean\":\n      return \"boolean\";\n    case \"null\":\n      return \"null\";\n    case \"object\":\n      return [\"{\", formatObjectProperties(param, indent + 2), \"}\"].join(\"\\n\");\n    case \"array\":\n      if (param.items) {\n        return `${formatType(param.items, indent)}[]`;\n      }\n      return \"any[]\";\n    default:\n      return \"\";\n  }\n}","map":{"version":3,"names":["isAnyOfProp","prop","anyOf","undefined","Array","isArray","formatFunctionDefinitions","functions","lines","f","description","push","Object","keys","parameters","properties","length","name","formatObjectProperties","join","obj","indent","param","entries","required","includes","formatType","map","line","repeat","v","type","enum","items"],"sources":["/Users/youngchen/Downloads/cs224g-triage/node_modules/@langchain/openai/dist/utils/openai-format-fndef.js"],"sourcesContent":["function isAnyOfProp(prop) {\n    return (prop.anyOf !== undefined &&\n        Array.isArray(prop.anyOf));\n}\n// When OpenAI use functions in the prompt, they format them as TypeScript definitions rather than OpenAPI JSON schemas.\n// This function converts the JSON schemas into TypeScript definitions.\nexport function formatFunctionDefinitions(functions) {\n    const lines = [\"namespace functions {\", \"\"];\n    for (const f of functions) {\n        if (f.description) {\n            lines.push(`// ${f.description}`);\n        }\n        if (Object.keys(f.parameters.properties ?? {}).length > 0) {\n            lines.push(`type ${f.name} = (_: {`);\n            lines.push(formatObjectProperties(f.parameters, 0));\n            lines.push(\"}) => any;\");\n        }\n        else {\n            lines.push(`type ${f.name} = () => any;`);\n        }\n        lines.push(\"\");\n    }\n    lines.push(\"} // namespace functions\");\n    return lines.join(\"\\n\");\n}\n// Format just the properties of an object (not including the surrounding braces)\nfunction formatObjectProperties(obj, indent) {\n    const lines = [];\n    for (const [name, param] of Object.entries(obj.properties ?? {})) {\n        if (param.description && indent < 2) {\n            lines.push(`// ${param.description}`);\n        }\n        if (obj.required?.includes(name)) {\n            lines.push(`${name}: ${formatType(param, indent)},`);\n        }\n        else {\n            lines.push(`${name}?: ${formatType(param, indent)},`);\n        }\n    }\n    return lines.map((line) => \" \".repeat(indent) + line).join(\"\\n\");\n}\n// Format a single property type\nfunction formatType(param, indent) {\n    if (isAnyOfProp(param)) {\n        return param.anyOf.map((v) => formatType(v, indent)).join(\" | \");\n    }\n    switch (param.type) {\n        case \"string\":\n            if (param.enum) {\n                return param.enum.map((v) => `\"${v}\"`).join(\" | \");\n            }\n            return \"string\";\n        case \"number\":\n            if (param.enum) {\n                return param.enum.map((v) => `${v}`).join(\" | \");\n            }\n            return \"number\";\n        case \"integer\":\n            if (param.enum) {\n                return param.enum.map((v) => `${v}`).join(\" | \");\n            }\n            return \"number\";\n        case \"boolean\":\n            return \"boolean\";\n        case \"null\":\n            return \"null\";\n        case \"object\":\n            return [\"{\", formatObjectProperties(param, indent + 2), \"}\"].join(\"\\n\");\n        case \"array\":\n            if (param.items) {\n                return `${formatType(param.items, indent)}[]`;\n            }\n            return \"any[]\";\n        default:\n            return \"\";\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}