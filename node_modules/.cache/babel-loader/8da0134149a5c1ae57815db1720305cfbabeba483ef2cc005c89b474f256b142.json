{"ast":null,"code":"import { parseDef } from \"../parseDef.mjs\";\nimport { primitiveMappings } from \"./union.mjs\";\nexport function parseNullableDef(def, refs) {\n  if (['ZodString', 'ZodNumber', 'ZodBigInt', 'ZodBoolean', 'ZodNull'].includes(def.innerType._def.typeName) && (!def.innerType._def.checks || !def.innerType._def.checks.length)) {\n    if (refs.target === 'openApi3' || refs.nullableStrategy === 'property') {\n      return {\n        type: primitiveMappings[def.innerType._def.typeName],\n        nullable: true\n      };\n    }\n    return {\n      type: [primitiveMappings[def.innerType._def.typeName], 'null']\n    };\n  }\n  if (refs.target === 'openApi3') {\n    const base = parseDef(def.innerType._def, {\n      ...refs,\n      currentPath: [...refs.currentPath]\n    });\n    if (base && '$ref' in base) return {\n      allOf: [base],\n      nullable: true\n    };\n    return base && {\n      ...base,\n      nullable: true\n    };\n  }\n  const base = parseDef(def.innerType._def, {\n    ...refs,\n    currentPath: [...refs.currentPath, 'anyOf', '0']\n  });\n  return base && {\n    anyOf: [base, {\n      type: 'null'\n    }]\n  };\n}","map":{"version":3,"names":["parseDef","primitiveMappings","parseNullableDef","def","refs","includes","innerType","_def","typeName","checks","length","target","nullableStrategy","type","nullable","base","currentPath","allOf","anyOf"],"sources":["/Users/youngchen/Downloads/cs224g-triage/node_modules/openai/src/_vendor/zod-to-json-schema/parsers/nullable.ts"],"sourcesContent":["import { ZodNullableDef } from 'zod';\nimport { JsonSchema7Type, parseDef } from '../parseDef';\nimport { Refs } from '../Refs';\nimport { JsonSchema7NullType } from './null';\nimport { primitiveMappings } from './union';\n\nexport type JsonSchema7NullableType =\n  | {\n      anyOf: [JsonSchema7Type, JsonSchema7NullType];\n    }\n  | {\n      type: [string, 'null'];\n    };\n\nexport function parseNullableDef(def: ZodNullableDef, refs: Refs): JsonSchema7NullableType | undefined {\n  if (\n    ['ZodString', 'ZodNumber', 'ZodBigInt', 'ZodBoolean', 'ZodNull'].includes(def.innerType._def.typeName) &&\n    (!def.innerType._def.checks || !def.innerType._def.checks.length)\n  ) {\n    if (refs.target === 'openApi3' || refs.nullableStrategy === 'property') {\n      return {\n        type: primitiveMappings[def.innerType._def.typeName as keyof typeof primitiveMappings],\n        nullable: true,\n      } as any;\n    }\n\n    return {\n      type: [primitiveMappings[def.innerType._def.typeName as keyof typeof primitiveMappings], 'null'],\n    };\n  }\n\n  if (refs.target === 'openApi3') {\n    const base = parseDef(def.innerType._def, {\n      ...refs,\n      currentPath: [...refs.currentPath],\n    });\n\n    if (base && '$ref' in base) return { allOf: [base], nullable: true } as any;\n\n    return base && ({ ...base, nullable: true } as any);\n  }\n\n  const base = parseDef(def.innerType._def, {\n    ...refs,\n    currentPath: [...refs.currentPath, 'anyOf', '0'],\n  });\n\n  return base && { anyOf: [base, { type: 'null' }] };\n}\n"],"mappings":"SAC0BA,QAAQ,QAAE;SAG3BC,iBAAiB,QAAE;AAU5B,OAAM,SAAUC,gBAAgBA,CAACC,GAAmB,EAAEC,IAAU;EAC9D,IACE,CAAC,WAAW,EAAE,WAAW,EAAE,WAAW,EAAE,YAAY,EAAE,SAAS,CAAC,CAACC,QAAQ,CAACF,GAAG,CAACG,SAAS,CAACC,IAAI,CAACC,QAAQ,CAAC,KACrG,CAACL,GAAG,CAACG,SAAS,CAACC,IAAI,CAACE,MAAM,IAAI,CAACN,GAAG,CAACG,SAAS,CAACC,IAAI,CAACE,MAAM,CAACC,MAAM,CAAC,EACjE;IACA,IAAIN,IAAI,CAACO,MAAM,KAAK,UAAU,IAAIP,IAAI,CAACQ,gBAAgB,KAAK,UAAU,EAAE;MACtE,OAAO;QACLC,IAAI,EAAEZ,iBAAiB,CAACE,GAAG,CAACG,SAAS,CAACC,IAAI,CAACC,QAA0C,CAAC;QACtFM,QAAQ,EAAE;OACJ;;IAGV,OAAO;MACLD,IAAI,EAAE,CAACZ,iBAAiB,CAACE,GAAG,CAACG,SAAS,CAACC,IAAI,CAACC,QAA0C,CAAC,EAAE,MAAM;KAChG;;EAGH,IAAIJ,IAAI,CAACO,MAAM,KAAK,UAAU,EAAE;IAC9B,MAAMI,IAAI,GAAGf,QAAQ,CAACG,GAAG,CAACG,SAAS,CAACC,IAAI,EAAE;MACxC,GAAGH,IAAI;MACPY,WAAW,EAAE,CAAC,GAAGZ,IAAI,CAACY,WAAW;KAClC,CAAC;IAEF,IAAID,IAAI,IAAI,MAAM,IAAIA,IAAI,EAAE,OAAO;MAAEE,KAAK,EAAE,CAACF,IAAI,CAAC;MAAED,QAAQ,EAAE;IAAI,CAAS;IAE3E,OAAOC,IAAI,IAAK;MAAE,GAAGA,IAAI;MAAED,QAAQ,EAAE;IAAI,CAAU;;EAGrD,MAAMC,IAAI,GAAGf,QAAQ,CAACG,GAAG,CAACG,SAAS,CAACC,IAAI,EAAE;IACxC,GAAGH,IAAI;IACPY,WAAW,EAAE,CAAC,GAAGZ,IAAI,CAACY,WAAW,EAAE,OAAO,EAAE,GAAG;GAChD,CAAC;EAEF,OAAOD,IAAI,IAAI;IAAEG,KAAK,EAAE,CAACH,IAAI,EAAE;MAAEF,IAAI,EAAE;IAAM,CAAE;EAAC,CAAE;AACpD","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}